(function(e){function n(){if(t)return t;var n=e('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div></div>');e("body").append(n);var r=e("div",n).innerWidth();n.css("overflow-y","auto");var i=e("div",n).innerWidth();e(n).remove();t=r-i;return t}var t=0;e.fn.tableScroll=function(t){if(t=="undo"){var r=e(this).parent().parent();if(r.hasClass("tablescroll_wrapper")){r.find(".tablescroll_head thead").prependTo(this);r.find(".tablescroll_foot tfoot").appendTo(this);r.before(this);r.empty()}return}var i=e.extend({},e.fn.tableScroll.defaults,t);i.scrollbarWidth=n();this.each(function(){var t=i.flush;var n=e(this).addClass("tablescroll_body");var r;if(n.parent().hasClass("tablescroll_wrapper")){r=n.parent()}else{r=e('<div class="tablescroll_wrapper"></div>').insertBefore(n).append(n)}if(!r.parent("div").hasClass(i.containerClass)){e("<div></div>").addClass(i.containerClass).insertBefore(r).append(r)}var s=i.width?i.width:n.outerWidth();r.css({width:s+"px",height:i.height+"px","overflow-y":"auto","overflow-x":"hidden"});n.css("width",s+"px");var o=r.outerWidth();var u=o-s;r.css({width:s-u+i.scrollbarWidth+"px"});n.css("width",s-u+"px");if(n.outerHeight()<=i.height){r.css({height:"auto",width:s-u+"px"});t=false}var a=e("thead",n).length?true:false;var f=e("tfoot",n).length?true:false;var l=e("thead tr:first",n);var c=e("tbody tr:first",n);var h=e("tfoot tr:first",n);var p=0;e("th, td",l).each(function(t){p=e(this).width();e("th:eq("+t+"), td:eq("+t+")",l).css("width",p+"px");e("th:eq("+t+"), td:eq("+t+")",c).css("width",p+"px");if(f)e("th:eq("+t+"), td:eq("+t+")",h).css("width",p+"px")});if(a){var d=e('<table class="tablescroll_head" cellspacing="0"></table>').insertBefore(r).prepend(e("thead",n))}if(f){var v=e('<table class="tablescroll_foot" cellspacing="0"></table>').insertAfter(r).prepend(e("tfoot",n))}if(d!=undefined){d.css("width",s+"px");if(t){e("tr:first th:last, tr:first td:last",d).css("width",p+i.scrollbarWidth+"px");d.css("width",r.outerWidth()+"px")}}if(v!=undefined){v.css("width",s+"px");if(t){e("tr:first th:last, tr:first td:last",v).css("width",p+i.scrollbarWidth+"px");v.css("width",r.outerWidth()+"px")}}});return this};e.fn.tableScroll.defaults={flush:true,width:null,height:100,containerClass:"tablescroll"}})(jQuery)